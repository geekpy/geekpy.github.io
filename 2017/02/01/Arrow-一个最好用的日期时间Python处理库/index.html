<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Arrow-一个最好用的日期时间Python处理库 | Geekpy's Blog</title><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/very-simple.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><!-- include the sidebar--><!-- include ./includes/sidebar.jade--><!-- Blog title and subtitle--><header><div class="container header"><a id="logo" href="/." class="title">Geekpy's Blog</a><span class="subtitle"></span><label id="toggle-menu" for="menu" onclick><i class="fa fa-bars"></i></label></div></header><!-- use checkbox hack for toggle nav-bar on small screens--><input id="menu" type="checkbox"><!-- Navigation Links--><nav id="nav"><div class="container"><a href="/" class="sidebar-nav-item active">Home</a><a href="/archives" class="sidebar-nav-item">Archives</a><a href="/about" class="sidebar-nav-item">About</a></div></nav><div id="header-margin-bar"></div><div class="wrapper"><div class="container post-header"><h1>Arrow-一个最好用的日期时间Python处理库</h1></div></div><article><div class="container post"><p>写过Python程序的人大都知道，Python日期和时间的处理非常繁琐和麻烦，主要有以下几个问题：</p>
<ul>
<li>有众多的package，类和方法，包括time，datetime，pytz等等</li>
<li>经常需要各种转换，比如时间戳，structtime，时间字符串之间相互转换，localtime和utctime的转换</li>
<li>难以记忆，有违人性的时间格式化字符串%Y %M %m %D %d</li>
</ul>
<p>基于以上几点，每次做时间处理的时候总是需要翻看以前的代码或者文档，可见此处Python做的有多烂，好了废话不多说，今天给大家介绍的这个arrow极大地解放了我等Python程序员的脑容量。</p>
<h3>安装</h3>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install arrow</span><br></pre></td></tr></table></figure></p>
<h3>使用</h3>
<h5>获取当前时间</h5>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">In [13]: import arrow</span><br><span class="line"></span><br><span class="line">In [14]: t = arrow.utcnow()</span><br><span class="line"></span><br><span class="line">In [15]: t</span><br><span class="line">Out[15]: &lt;Arrow [2017-02-01T08:30:37.627622+00:00]&gt;</span><br><span class="line"></span><br><span class="line">In [19]: arrow.now()</span><br><span class="line">Out[19]: &lt;Arrow [2017-02-01T16:32:02.857411+08:00]&gt;</span><br></pre></td></tr></table></figure></p>
<p>通过utcnow()和now()分别获取了utc时间和local时间，最终获取的是一个Arrow时间对象，通过这个对象我们可以做各种时间转换，后边会看到。</p>
<h5>时间形式转换</h5>
<p>我们经常需要转换时间对象，比如转换称timestamp，有时需要转换成特定格式的时间字符串。</p>
<ul>
<li>转换成timestamp</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">In [13]: import arrow</span><br><span class="line"></span><br><span class="line">In [14]: t = arrow.utcnow()</span><br><span class="line"></span><br><span class="line">In [16]: t.timestamp</span><br><span class="line">Out[16]: 1485937837</span><br></pre></td></tr></table></figure></p>
<ul>
<li>转换成时间字符串</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">In [23]: t = arrow.now()</span><br><span class="line"></span><br><span class="line">In [24]: t.format()</span><br><span class="line">Out[24]: u&apos;2017-02-01 17:00:42+08:00&apos;</span><br><span class="line"></span><br><span class="line">In [25]: t.format(&quot;YYYY-MM-DD HH:mm&quot;)</span><br><span class="line">Out[25]: u&apos;2017-02-01 17:00&apos;</span><br></pre></td></tr></table></figure></p>
<p>怎么样？是不是感觉很简单，心里感觉轻舒了一口气！这里可以注意到格式化字符串非常人性化便于记忆，对不对？完整的时间格式字符串参见<a href="http://arrow.readthedocs.io/en/latest/#tokens" target="_blank" rel="noopener">这里</a></p>
<ul>
<li>从字符串转换成Arrow对象</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">In [20]: arrow.get(&quot;2017-01-20 11:30&quot;, &quot;YYYY-MM-DD HH:mm&quot;)</span><br><span class="line">Out[20]: &lt;Arrow [2017-01-20T11:30:00+00:00]&gt;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>从时间戳转化为Arrow对象</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">In [26]: arrow.get(&quot;1485937858.659424&quot;)</span><br><span class="line">Out[26]: &lt;Arrow [2017-02-01T08:30:58.659424+00:00]&gt;</span><br><span class="line"></span><br><span class="line">In [27]: arrow.get(1485937858.659424)</span><br><span class="line">Out[27]: &lt;Arrow [2017-02-01T08:30:58.659424+00:00]&gt;</span><br></pre></td></tr></table></figure></p>
<p>注意这里无论传递的是时间戳字符串还是float类型的时间戳都可以进行转化，很人性有木有？</p>
<ul>
<li>直接生成Arrow对象</li>
</ul>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">In [28]: arrow.Arrow(2017, 2, 1)</span><br><span class="line">Out[28]: &lt;Arrow [2017-02-01T00:00:00+00:00]&gt;</span><br><span class="line"></span><br><span class="line">In [29]: arrow.get(2017, 2, 1)</span><br><span class="line">Out[29]: &lt;Arrow [2017-02-01T00:00:00+00:00]&gt;</span><br></pre></td></tr></table></figure></p>
<h5>时间推移</h5>
<p>时间推移就是要获取某个时间之前的时间或者之后的时间，比如要获取相对于当前时间前一天的时间。
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">In [30]: t = arrow.now()</span><br><span class="line">In [31]: t</span><br><span class="line">Out[31]: &lt;Arrow [2017-02-01T17:19:19.933507+08:00]&gt;</span><br><span class="line"></span><br><span class="line">In [33]: t.shift(days=-1)  # 前一天</span><br><span class="line">Out[33]: &lt;Arrow [2017-01-31T17:19:19.933507+08:00]&gt;</span><br><span class="line"></span><br><span class="line">In [34]: t.shift(weeks=-1)  # 前一周</span><br><span class="line">Out[34]: &lt;Arrow [2017-01-25T17:19:19.933507+08:00]&gt;</span><br><span class="line"></span><br><span class="line">In [35]: t.shift(months=-2) # 前两个月</span><br><span class="line">Out[35]: &lt;Arrow [2016-12-01T17:19:19.933507+08:00]&gt;</span><br><span class="line"></span><br><span class="line">In [37]: t.shift(years=1)  # 明年</span><br><span class="line">Out[37]: &lt;Arrow [2018-02-01T17:19:19.933507+08:00]&gt;</span><br></pre></td></tr></table></figure></p>
<p>看是不是很简单，比用timedelta要简单明了多了，是不是？</p>
<p>更多请参考官方文档和Github
<a href="http://arrow.readthedocs.io/en/latest/" target="_blank" rel="noopener">官方文档</a>
<a href="https://github.com/crsmithdev/arrow/" target="_blank" rel="noopener">Github</a>
顺便说一句点赞是一种美德，Arrow第4000个赞就是我点的，哈哈。如果你觉的我的文章有帮助，也赶紧点个赞吧！</p>
</div><div class="container"><hr><div class="comment"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="//cdn.jsdelivr.net/npm/valine@1.1.6/dist/Valine.min.js"></script>
<script type="text/javascript">
var leancloud_appid = '';
var leancloud_appkey = '';
var valine_url = 'http://yoursite.com/2017/02/01/Arrow-一个最好用的日期时间Python处理库/';
var valine_notify = false;
var valine_verify = false;
var valine_placeholder = 'input your comments here';
new Valine({
         av: AV, // source from av-min.js
         el: '.comment' ,
         notify: valine_notify,
         verify: valine_verify,
         app_id: leancloud_appid,
         app_key: leancloud_appkey,
         placeholder: valine_placeholder,
         path: valine_url
     });
</script></div></article><footer id="footer"><div class="container"><div class="bar"><div class="social"><a href="mailto:rebor.liu@gmail.com" target="_blank"><i class="fa fa-envelope-o"></i></a><a href="https://github.com/geekpy" target="_blank"><i class="fa fa-github"></i></a></div><div class="footer">© 2018 <a href="/" rel="nofollow">geekpy</a>. Powered by <a rel="nofollow" target="_blank" href="https://hexo.io">Hexo</a>. Theme <a target="_blank" href="https://github.com/lotabout/very-simple">very-simple</a>.</div></div></div></footer><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
    $(".fancybox").fancybox();
});
</script></body></html>